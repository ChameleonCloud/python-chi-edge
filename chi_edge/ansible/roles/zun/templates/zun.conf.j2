[DEFAULT]
debug = {{ zun_logging_debug }}

log_dir = /var/log/kolla/zun
transport_url = rabbit://{{ rpc_user }}:{{ rpc_password }}@{{ site_internal_vip }}:5672

state_path = /var/lib/zun
container_driver = docker
capsule_driver = cri

[network]
driver = kuryr

[database]
connection = mysql+pymysql://{{ zun_database_user }}:{{ zun_database_password }}@{{ site_internal_vip }}/zun
connection_recycle_time = {{ database_connection_recycle_time }}
max_pool_size = {{ database_max_pool_size }}
max_retries = -1

# NOTE(yoctozepto): despite what the docs say, both keystone_auth and
# keystone_authtoken sections are used and Zun internals may use either -
# - best keep them both in sync
[keystone_auth]
www_authenticate_uri = {{ keystone_internal_url }}
auth_url = {{ keystone_admin_url }}
auth_type = password
project_domain_id = default
user_domain_id = default
project_name = {{ keystone_project_name }}
username = {{ zun_keystone_user }}
password = {{ zun_keystone_password }}
service_token_roles_required = True
region_name = {{ openstack_region_name }}
cafile = {{ openstack_cacert }}

# NOTE(yoctozepto): despite what the docs say, both keystone_auth and
# keystone_authtoken sections are used and Zun internals may use either -
# - best keep them both in sync
[keystone_authtoken]
www_authenticate_uri = {{ keystone_internal_url }}
auth_url = {{ keystone_admin_url }}
auth_type = password
project_domain_id = default
user_domain_id = default
project_name = {{ keystone_project_name }}
username = {{ zun_keystone_user }}
password = {{ zun_keystone_password }}
service_token_roles_required = True
region_name = {{ openstack_region_name }}
cafile = {{ openstack_cacert }}

[zun_client]
region_name = {{ openstack_region_name }}
endpoint_type = internalURL
ca_file = {{ openstack_cacert }}

[glance_client]
region_name = {{ openstack_region_name }}
endpoint_type = internalURL
ca_file = {{ openstack_cacert }}

[neutron_client]
region_name = {{ openstack_region_name }}
endpoint_type = internalURL
ca_file = {{ openstack_cacert }}

[cinder_client]
region_name = {{ openstack_region_name }}
endpoint_type = internalURL
ca_file = {{ openstack_cacert }}

[placement_client]
region_name = {{ openstack_region_name }}
endpoint_type = internalURL
ca_file = {{ openstack_cacert }}

[cyborg_client]
region_name = {{ openstack_region_name }}
endpoint_type = internalURL
ca_file = {{ openstack_cacert }}

[oslo_concurrency]
lock_path = /var/lib/zun/tmp

[compute]
host_shared_with_nova = False

[docker]
api_url = tcp://{{ mgmt_ipv4 }}:2375
docker_remote_api_host = {{ mgmt_ipv4 }}
docker_remote_api_port = 2375

[cni_daemon]
cni_daemon_port = 9036
